<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <title>Seanox aspect-js test environment</title>
    <style type="text/css">
      body {
        font-family:monospace; white-space:pre;
      }
    </style>
    <script src="../sources/composite.js"></script>
    <script src="../sources/test.js"></script>
    <script type="text/javascript">
    
        var TestBean = {};
        TestBean.ticks = 0;
        TestBean.ping = function() {
            return ++TestBean.ticks + "-" + "{{TestBean.ping()}}";
        };
        
        Test.create({test:function() {
            var expected = document.querySelector("script[type='text/test']");
            expected = expected.innerHTML.trim();
            expected = expected.replace(/\t/g, '    ');
            var actual = document.querySelector("body");
            actual = actual.innerHTML.trim();
            actual = actual.replace(/\t/g, '    ');
            Assert.assertEquals(expected, actual);            
        }}); 
        Composite.listen(Composite.EVENT_RENDER_END, function() {
            Test.start();
        }); 
    </script>
    <script type="text/test">
    A:<text>1-{{TestBean.ping()}}</text> 
    B:<text>2-{{TestBean.ping()}}</text> 
    C:<text>3-{{TestBean.ping()}}</text>
    
    D:<input value="4-{{TestBean.ping()}}" type="text">
    E:<input value="5-{{TestBean.ping()}}" type="text">
    F:<input value="6-{{TestBean.ping()}}" type="text">
    </script>
  </head>
  <body>
    A:{{TestBean.ping()}} 
    B:{{TestBean.ping()}} 
    C:{{TestBean.ping()}}
    
    D:<input type="text" value="{{TestBean.ping()}}"/>
    E:<input type="text" value="{{TestBean.ping()}}"/>
    F:<input type="text" value="{{TestBean.ping()}}"/>
  </body>
</html>