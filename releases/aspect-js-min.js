"undefined"==typeof Namespace&&(window.Namespace={get PATTERN_NAMESPACE_SEPARATOR(){return/\./},get PATTERN_NAMESPACE(){return/^\w+(\.\w+)*$/i}},Namespace.locate=function(e){var t,r;if(0==arguments.length)return{scope:window};if(arguments.length>1)t=arguments[0],r=arguments[1];else{if(!(arguments.length>0))throw new TypeError("Invalid namespace");t=window,r=arguments[0]}if("object"!=typeof t)throw new TypeError("Invalid scope: "+typeof t);if("string"!=typeof r)throw new TypeError("Invalid namespace: "+typeof r);if(!r.match(Namespace.PATTERN_NAMESPACE)||t==window&&r.match(/^\d/))throw new Error("Invalid namespace"+(r.trim()?": "+r:""));return{scope:t,namespace:r}},Namespace.using=function(...e){if(0==arguments.length)return window;var t=Namespace.locate(...e);return void 0===t.namespace?t.scope:(t.namespace.split(Namespace.PATTERN_NAMESPACE_SEPARATOR).forEach((e,r,o)=>{if(void 0===t.scope[e])r<o.length-1&&o[r+1].match(/^\d+$/)?t.scope[e]=[]:t.scope[e]={};else if(!(t.scope[e]instanceof Object||null===t.scope[e]))throw new Error("Invalid namespace: "+o.slice(0,r+1).join("."));t.scope=t.scope[e]}),t.scope)},Namespace.lookup=function(...e){if(0==arguments.length)return window;var t=Namespace.locate(...arguments);if(void 0===t.namespace)return t.scope;if(t.namespace=t.namespace.split(Namespace.PATTERN_NAMESPACE_SEPARATOR),!t.namespace||t.namespace.length<=0)return null;for(var r=0;t.scope&&r<t.namespace.length;r++){if(!(t.namespace[r]in t.scope&&(t.scope[t.namespace[r]]instanceof Object||null===t.scope[t.namespace[r]])))return null;t.scope=t.scope[t.namespace[r]]}return t.scope},Namespace.exists=function(...e){return null!=Namespace.lookup(...e)}),Element.prototype.appendChild$origin=Element.prototype.appendChild,Element.prototype.appendChild=function(e,t){if(t&&(this.innerHTML=""),e instanceof Node)this.appendChild$origin(e);else if(Array.isArray(e)||e instanceof NodeList||Symbol&&Symbol.iterator&&e&&(e[Symbol.iterator],1)){e=Array.from(e);for(var r=0;r<e.length;r++)this.appendChild$origin(e[r])}else this.appendChild$origin(e)},void 0===Math.uniqueId&&(Math.uniqueId=function(e){(e=e||16)<0&&(sitze=16);for(var t="",r=0;r<e;r++){var o=Math.floor(Math.random()*Math.floor(26));Math.floor(Math.random()*Math.floor(26))%2==0?t+=String(o%10):t+=String.fromCharCode(65+o)}return t}),void 0===Math.uniqueSerialId&&(Math.uniqueSerialId=function(e){(e=e||16)<0&&(e=16);var t="";return t=((t=((new Date).getTime()-9466848e5).toString(36)).length.toString(36)+t).toUpperCase(),(t=Math.uniqueId()+t).length>e&&(t=t.substr(t.length-e)),t}),void 0===RegExp.quote&&(RegExp.quote=function(e){return null==e||null==e?null:String(e).replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}),void 0===String.prototype.capitalize&&(String.prototype.capitalize=function(){return this.length<=0?this:this.charAt(0).toUpperCase()+this.slice(1)}),void 0===String.prototype.uncapitalize&&(String.prototype.uncapitalize=function(){return this.length<=0?this:this.charAt(0).toLowerCase()+this.slice(1)}),void 0===String.prototype.encodeHex&&(String.prototype.encodeHex=function(){for(var e="",t=0;t<this.length;t++){for(var r=Number(this.charCodeAt(t)).toString(16).toUpperCase();r.length<2;)r="0"+r;e+=r}return"0x"+e}),void 0===String.prototype.decodeHex&&(String.prototype.decodeHex=function(){var e=this;e.match(/^0x/)&&(e=e.substring(2));for(var t="",r=0;r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}),void 0===String.prototype.encodeBase64&&(String.prototype.encodeBase64=function(){try{return btoa(encodeURIComponent(this).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)))}catch(e){throw new Error("malformed character sequence")}}),void 0===String.prototype.decodeBase64&&(String.prototype.decodeBase64=function(){try{return decodeURIComponent(atob(this).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))}catch(e){throw new Error("malformed character sequence")}}),void 0===String.prototype.encodeHtml&&(String.prototype.encodeHtml=function(){var e=document.createElement("div");return e.textContent=this,e.innerHTML}),void 0===String.prototype.hashCode&&(String.prototype.hashCode=function(){if(null==this.hash&&(this.hash=0),0!=this.hash)return this.hash;for(var e=0,t=0;e<this.length;e++){var r=31*this.hash+this.charCodeAt(e);Number.isSafeInteger(r)?this.hash=r:(t++,this.hash=Number.MAX_SAFE_INTEGER-this.hash+this.charCodeAt(e))}return this.hash=Math.abs(this.hash),this.hash=this.hash.toString(36),this.hash=this.hash.length.toString(36)+this.hash,this.hash=this.hash+t.toString(36),this.hash=this.hash.toUpperCase(),this.hash}),void 0===String.prototype.unescape&&(String.prototype.unescape=function(){var text=this;return text=text.replace(/\r/g,"\\r"),text=text.replace(/\n/g,"\\n"),text=text.replace(/^(["'])/,"$1"),text=text.replace(/([^\\])((?:\\{2})*)(?=["'])/g,"$1$2\\"),eval('"'+text+'"')}),void 0===window.serial&&Object.defineProperty(window,"serial",{value:Math.uniqueSerialId()}),void 0===window.location.pathcontext&&Object.defineProperty(window.location,"pathcontext",{value:window.location.pathname.replace(/\/([^\/]*\.[^\/]*){0,}$/g,"")||"/"}),"undefined"==typeof DataSource&&(window.DataSource={get DATA(){return window.location.pathcontext+"/data"},get PATTERN_LOCATOR(){return/^(?:([a-z]+):\/+)(\/((\w+)|(\w+(\-+\w+)+)))+$/},get PATTERN_JAVASCRIPT(){return/^\s*text\s*\/\s*javascript\s*$/i},get PATTERN_WORD(){return/(^\w+$)|(^((\w+\-+(?=\w))+)\w*$)/},get ATTRIBUTE_TYPE(){return"type"},get locale(){return DataSource.locales?DataSource.locales.selection:null}},void 0===XMLDocument.prototype.clone&&(XMLDocument.prototype.clone=function(){var e=this.implementation.createDocument(this.namespaceURI,null,null),t=e.importNode(this.documentElement,!0);return e.appendChild(t),e}),function(){Object.defineProperty(DataSource,"cache",{value:{}}),Object.defineProperty(DataSource,"locales",{value:[],enumerable:!0});var e=[];if(e=e.concat(navigator.language),void 0!==navigator.languages&&(e=e.concat(navigator.languages)),Array.from(e).forEach(t=>{(t=t.match(/^[a-z]+/i,""))&&!e.includes(t[0])&&e.push(t[0])}),(e=(e=e.map(e=>e.trim().toLowerCase())).filter(function(t,r){return e.indexOf(t)==r})).length<=0)throw new Error("Locale not available");var t=new XMLHttpRequest;if(t.open("HEAD",DataSource.DATA+"/locales.xml",!1),t.send(),404!=t.status){if(t.open("GET",DataSource.DATA+"/locales.xml",!1),t.overrideMimeType("application/xslt+xml"),t.send(),Object.defineProperty(DataSource,"data",{value:200==t.status?t.responseXML:null}),!DataSource.data&&404!=t.status)throw new Error("Locale not available");if(DataSource.data){for(var r=DataSource.data,o=(i=r.evaluate("/locales/*[@default]",r,null,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null)).iterateNext();o;o=i.iterateNext()){var a=o.nodeName.toLowerCase();DataSource.locales.includes(a)||DataSource.locales.push(a)}var i;for(o=(i=r.evaluate("/locales/*",r,null,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null)).iterateNext();o;o=i.iterateNext()){a=o.nodeName.toLowerCase();DataSource.locales.includes(a)||DataSource.locales.push(a)}if(DataSource.locales.length<=0)throw new Error("Locale not available");e.push(DataSource.locales[0]),e=e.filter(function(e){return DataSource.locales.includes(e)}),DataSource.locales.selection=e.length?e[0]:DataSource.locales[0]}}}(),DataSource.localize=function(e){if(!DataSource.data||!DataSource.locales)throw new Error("Locale not available");if("string"!=typeof e)throw new TypeError("Invalid locale: "+typeof e);if(!(e=(e||"").trim().toLowerCase())||!DataSource.locales.includes(e))throw new Error("Locale not available");DataSource.locales.selection=e},DataSource.transform=function(e,t,r){if("string"==typeof e&&e.match(DataSource.PATTERN_LOCATOR)&&(e=DataSource.fetch(e)),"string"==typeof t&&t.match(DataSource.PATTERN_LOCATOR)&&(t=DataSource.fetch(t)),!(e instanceof XMLDocument))throw new TypeError("Invalid xml document");if(!(t instanceof XMLDocument))throw new TypeError("Invalid xml stylesheet");var o=new XSLTProcessor;if(o.importStylesheet(t),r&&"object"==typeof r){var a="function"!=typeof r[Symbol.iterator]?Object.entries(r):r;for(const[e,t]of a)"function"!=typeof r[e]&&o.setParameter(null,e,t)}var i=e.evaluate("string(/*/@escape)",e,null,XPathResult.ANY_TYPE,null).stringValue;i=!!i.match(/^yes|on|true|1$/i);var n=o.transformToDocument(e);(s=n.querySelectorAll(i?"*":"*[escape]")).forEach(e=>{if(i||(e.getAttribute("escape")||"on").match(/^yes|on|true|1$/i)){var t=e.innerHTML;t.indexOf("<")<0&&t.indexOf(">")<0&&(e.innerHTML=e.textContent)}e.removeAttribute("escape")}),(s=n.querySelectorAll("script[type],script:not([type])")).forEach(e=>{e.hasAttribute(DataSource.ATTRIBUTE_TYPE)&&!(e.getAttribute(DataSource.ATTRIBUTE_TYPE)||"").match(DataSource.PATTERN_JAVASCRIPT)||e.setAttribute("type","composite/javascript")});var s=n.childNodes;n.body?s=n.body.childNodes:n.firstChild&&n.firstChild.nodeName.match(/^transformiix\b/i)&&(s=n.firstChild.childNodes);var p=document.createDocumentFragment();s=Array.from(s);for(var l=0;l<s.length;l++)p.appendChild(s[l]);return p},DataSource.fetch=function(e,t,r){if("string"!=typeof e||!e.match(DataSource.PATTERN_LOCATOR))throw new Error("Invalid locator: "+String(e));var o=e.match(DataSource.PATTERN_LOCATOR)[1],a=e.match(DataSource.PATTERN_LOCATOR)[2];if(1==arguments.length){if(DataSource.cache=DataSource.cache||{},n=(n=DataSource.DATA+"/"+DataSource.locale+"/"+a+"."+o).replace(/\/+/g,"/"),hash=n.hashCode(),DataSource.cache.hasOwnProperty(hash))return DataSource.cache[hash];var i=new XMLHttpRequest;if(i.open("GET",n,!1),i.overrideMimeType("application/xslt+xml"),i.send(),200!=i.status)throw new Error("HTTP status "+i.status+" for "+i.responseURL);return n=i.responseXML,DataSource.cache[hash]=n,n}if(!o.match(/^xml$/)&&t)throw new Error("Transformation is not supported for this locator");var n=DataSource.fetch(e);if(!t)return n.clone();var s=e.replace(/(^((\w+\-+(?=\w))+)\w*)|(^\w+)/,"xslt");if("boolean"!=typeof t&&("string"!=typeof(s=t)||!s.match(DataSource.PATTERN_LOCATOR)))throw new Error("Invalid style: "+String(s));return DataSource.transform(n,DataSource.fetch(s),r)},DataSource.collect=function(e){if(arguments.length<=0)return null;var t=[],r="collection";if(2==arguments.length&&"string"==typeof arguments[0]&&Array.isArray(arguments[1])){if(!arguments[0].match(DataSource.PATTERN_WORD))throw new TypeError("Invalid collector");r=arguments[0],t=Array.from(arguments[1])}else t=1==arguments.length&&Array.isArray(arguments[0])?t.concat(arguments[0]):Array.from(arguments);DataSource.cache=DataSource.cache||{};var o=r.hashCode()+":"+t.join().hashCode();if(t.forEach(e=>{o+=":"+String(e).hashCode()}),DataSource.cache.hasOwnProperty(o))return DataSource.cache[o].clone();var a=document.implementation.createDocument(null,r,null,null);return t.forEach(e=>{if("string"!=typeof e)throw new TypeError("Invalid collection entry");a.documentElement.appendChild(DataSource.fetch(e).documentElement.cloneNode(!0))}),DataSource.cache[o]=a,a.clone()}),"undefined"==typeof Messages&&(window.Messages={},function(){var e=DataSource.localize;DataSource.localize=(e=>{DataSource.localize$origin(e),window.Messages={};for(var t="/locales/"+DataSource.locale+"/label",r=DataSource.data.evaluate(t,DataSource.data,null,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),o=r.iterateNext();o;o=r.iterateNext()){var a=(o.getAttribute("key")||"").trim();if(""!=a){var i=((o.getAttribute("value")||"").trim()+" "+o.textContent.trim()).trim();i=i.unescape(),Messages.hasOwnProperty(a)||Object.defineProperty(Messages,a,{value:i})}}}),DataSource.localize$origin=e,DataSource.data&&DataSource.locale&&DataSource.locales&&DataSource.locales.includes(DataSource.locale)&&DataSource.localize(DataSource.locale)}()),"undefined"==typeof Composite&&(window.Composite={get MODULES(){return window.location.pathcontext+"/modules"},get ATTRIBUTE_COMPOSITE(){return"composite"},get ATTRIBUTE_CONDITION(){return"condition"},get ATTRIBUTE_EVENTS(){return"events"},get ATTRIBUTE_ID(){return"id"},get ATTRIBUTE_IMPORT(){return"import"},get ATTRIBUTE_INTERVAL(){return"interval"},get ATTRIBUTE_ITERATE(){return"iterate"},get ATTRIBUTE_MESSAGE(){return"message"},get ATTRIBUTE_NOTIFICATION(){return"notification"},get ATTRIBUTE_NAME(){return"name"},get ATTRIBUTE_OUTPUT(){return"output"},get ATTRIBUTE_RENDER(){return"render"},get ATTRIBUTE_RELEASE(){return"release"},get ATTRIBUTE_TEXT(){return"text"},get ATTRIBUTE_TYPE(){return"type"},get ATTRIBUTE_VALIDATE(){return"validate"},get ATTRIBUTE_VALUE(){return"value"},get PATTERN_ATTRIBUTE_ACCEPT(){return/^(composite|condition|events|id|import|interval|iterate|message|notification|output|release|render|validate)$/i},get PATTERN_ATTRIBUTE_STATIC(){return/^(composite|id)$/i},get PATTERN_EXPRESSION_CONTAINS(){return/\{\{.*?\}\}/g},get PATTERN_EXPRESSION_CONDITION(){return/^\s*\{\{\s*(([^}]|(}(?!})))*?)\s*\}\}\s*$/i},get PATTERN_EXPRESSION_VARIABLE(){return/^\s*\{\{\s*((?:(?:_*[a-z])|(?:_\w*))\w*)\s*:\s*(([^}]|(}(?!})))*?)\s*\}\}\s*$/i},get PATTERN_ELEMENT_IGNORE(){return/script|style/i},get PATTERN_SCRIPT(){return/script/i},get PATTERN_COMPOSITE_SCRIPT(){return/^composite\/javascript$/i},get PATTERN_COMPOSITE_ID(){return/(^\w+$)|(^((\w+\-+(?=\w))+)\w*$)/},get PATTERN_ELEMENT_ID(){return/^((?:(?:(?:\w+\-+(?=\w))+)\w*)|(?:\w+))((\:(((((\w+\-+(?=\w))+)\w*)|(\w+))))*)$/},get PATTERN_CUSTOMIZE_SCOPE(){return/(^\w+$)|(^((\w+\-+(?=\w))+)\w*$)/},get PATTERN_NAMESPACE_SEPARATOR(){return/[\.:]/g},get PATTERN_NAMESPACE(){return/^\w+(\.\w+)*(\:\w+)*$/i},get PATTERN_DATASOURCE_URL(){return/^\s*xml:\s*(\/[^\s]+)\s*(?:\s*(?:xslt|xsl):\s*(\/[^\s]+))*$/i},get PATTERN_EVENT(){return/^([A-Z][a-z]+)+$/},get EVENT_RENDER_START(){return"RenderStart"},get EVENT_RENDER_NEXT(){return"RenderNext"},get EVENT_RENDER_END(){return"RenderEnd"},get EVENT_MOUNT_START(){return"MountStart"},get EVENT_MOUNT_NEXT(){return"MountNext"},get EVENT_MOUNT_END(){return"MountEnd"},get EVENT_HTTP_START(){return"HttpStart"},get EVENT_HTTP_PROGRESS(){return"HttpProgress"},get EVENT_HTTP_RECEIVE(){return"HttpReceive"},get EVENT_HTTP_LOAD(){return"HttpLoad"},get EVENT_HTTP_ABORT(){return"HttpAbort"},get EVENT_HTTP_TIMEOUT(){return"HttpTimeout"},get EVENT_HTTP_ERROR(){return"HttpError"},get EVENT_HTTP_END(){return"HttpEnd"},get EVENT_ERROR(){return"Error"},get events(){return"abort after|print animation|end animation|iteration animation|start before|print before|unload blur can|play can|play|through change click context|menu copy cut dbl|click drag drag|end drag|enter drag|leave drag|over drag|start drop duration|change ended error focus focus|in focus|out hash|change input invalid key|down key|press key|up load loaded|data loaded|meta|data load|start message mouse|down mouse|enter mouse|leave mouse|move mouse|over mouse|out mouse|up mouse|wheel offline online open page|hide page|show paste pause play playing popstate progress rate|change resize reset scroll search seeked seeking select show stalled storage submit suspend time|update toggle touch|cancel touch|end touch|move touch|start transition|end unload volume|change waiting wheel"},get PATTERN_EVENT_FUNCTIONS(){return e=Composite.events.replace(/(?:\||\b)(\w)/g,(e,t)=>t.toUpperCase()),e=new RegExp("^on("+e.replace(/\s+/g,"|")+")");var e},get PATTERN_EVENT_NAMES(){return Composite.events.replace(/(?:\||\b)(\w)/g,(e,t)=>t.toUpperCase()).split(/\s+/)},get PATTERN_EVENT_FILTER(){return Composite.events.replace(/(?:\||\b)(\w)/g,(e,t)=>t.toUpperCase()).toLowerCase().split(/\s+/)}},Object.defineProperty(Composite,"statics",{value:new Set}),Object.defineProperty(Composite,"macros",{value:new Map}),Object.defineProperty(Composite,"selectors",{value:new Map}),Object.defineProperty(Composite,"acceptors",{value:new Set}),Object.defineProperty(Composite,"listeners",{value:new Map}),Object.defineProperty(Composite,"models",{value:new Set}),Composite.lock=function(e,t){if(e.queue=e.queue||[],void 0===e.lock||!1===e.lock)if(e.lock={ticks:1,selector:t,queue:[],share(){return this.ticks++,this},release(){if(this.ticks--,!(this.ticks>0)){if(e==Composite.render){var t=[];if("string"==typeof this.selector){var r=document.querySelectorAll(this.selector);Array.from(r).forEach(e=>{t.includes(e)||t.push(e);var r=e.querySelectorAll("*");Array.from(r).forEach(e=>{t.includes(e)||t.push(e)})})}else this.selector instanceof Element&&(t=this.selector.querySelectorAll("*"),t=[this.selector].concat(Array.from(t)));t.forEach(e=>{Composite.mount(e)}),Composite.fire(Composite.EVENT_RENDER_END,this.selector)}else{if(e!=Composite.mount)throw new Error("Invalid context: "+e);Composite.fire(Composite.EVENT_MOUNT_END,this.selector)}var o=e.queue.shift();o&&Composite.asynchron(e,o),e.lock=!1}}},e==Composite.render)Composite.fire(Composite.EVENT_RENDER_START,this.selector);else{if(e!=Composite.mount)throw new Error("Invalid context: "+e);Composite.fire(Composite.EVENT_MOUNT_START,this.selector)}else if(e==Composite.render)Composite.fire(Composite.EVENT_RENDER_NEXT,this.selector);else{if(e!=Composite.mount)throw new Error("Invalid context: "+e);Composite.fire(Composite.EVENT_MOUNT_NEXT,this.selector)}return e.lock},void 0===Object.indication&&(Object.indication=0),void 0===Object.prototype.ordinal&&(Object.prototype.ordinal=function(){return this.serial=this.serial||++Object.indication,this.serial}),void 0===Object.locate&&(Object.locate=function(e){var t,r;if(0==arguments.length)return{scope:window};if(arguments.length>1)t=arguments[0],r=arguments[1];else{if(!(arguments.length>0))throw new TypeError("Invalid namespace");t=window,r=arguments[0]}if("object"!=typeof t)throw new TypeError("Invalid scope: "+typeof t);if("string"!=typeof r)throw new TypeError("Invalid namespace: "+typeof r);if(!r.match(Composite.PATTERN_NAMESPACE)||t==window&&r.match(/^\d/))throw new Error("Invalid namespace"+(r.trim()?": "+r:""));return{scope:t,namespace:r=r.replace(Composite.PATTERN_NAMESPACE_SEPARATOR,".")}}),void 0===Object.using&&(Object.using=function(...e){var t=Object.locate(...e);return void 0===t.namespace?t.scope:Namespace.using.call(null,t.scope,t.namespace)}),void 0===Object.lookup&&(Object.lookup=function(...e){var t=Object.locate(...e);return void 0===t.namespace?t.scope:Namespace.lookup.call(null,t.scope,t.namespace)}),void 0===Object.exists&&(Object.exists=function(...e){return null!=Object.lookup(...e)}),XMLHttpRequest.prototype.open$origin=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(...e){var t=(e=null)=>{if(e){if("loadstart"==e.type)e=[Composite.EVENT_HTTP_START,e];else if("progress"==e.type)e=[Composite.EVENT_HTTP_PROGRESS,e];else if("readystatechange"==e.type)e=[Composite.EVENT_HTTP_RECEIVE,e];else if("load"==e.type)e=[Composite.EVENT_HTTP_LOAD,e];else if("abort"==e.type)e=[Composite.EVENT_HTTP_ABORT,e];else if("error"==e.type)e=[Composite.EVENT_HTTP_ERROR,e];else if("timeout"==e.type)e=[Composite.EVENT_HTTP_TIMEOUT,e];else{if("loadend"!=e.type)return;e=[Composite.EVENT_HTTP_END,e]}Composite.fire(...e)}};void 0===this.open$init&&(this.open$init=!0,this.addEventListener("loadstart",t),this.addEventListener("progress",t),this.addEventListener("readystatechange",t),this.addEventListener("load",t),this.addEventListener("abort",t),this.addEventListener("error",t),this.addEventListener("timeout",t),this.addEventListener("loadend",t)),this.open$origin(...e)},Composite.listen=function(e,t){if("string"!=typeof e)throw new TypeError("Invalid event: "+typeof e);if("function"!=typeof t&&null!=t)throw new TypeError("Invalid callback: "+typeof t);if(!e.match(Composite.PATTERN_EVENT))throw new Error("Invalid event"+(e.trim()?": "+e:""));e=e.toLowerCase(),Composite.listeners.has(e)&&Array.isArray(Composite.listeners.get(e))||Composite.listeners.set(e,[]),Composite.listeners.get(e).push(t)},Composite.fire=function(e,...t){if(e=(e||"").trim(),!(Composite.listeners.size<=0)&&e){var r=Composite.listeners.get(e.toLowerCase());Array.isArray(r)&&(t=[e,...t],r.forEach(e=>{e(...t)}))}},Composite.asynchron=function(e,...t){window.setTimeout((e,...t)=>{e(...t)},0,e,...t)},Composite.validate=function(e,t){if((arguments.length<2||!1!==t)&&(t=!0),"string"==typeof e){if(!(e=e.trim()))return;return(p=Array.from(document.querySelectorAll(e))).forEach((e,r,o)=>{p[r]=Composite.validate(e,t),void 0===p[r]?p[r]=0:p[r]=!0===p[r]?1:2}),!!(p=p.join("")).match(/^1+$/)||!p.match(/2/)&&void 0}if(e instanceof Element){var r=e.ordinal(),o=Composite.render.meta[r],a=!0,i=Composite.mount.lookup(e);if(i instanceof Object){var n,s;if("function"==typeof e.setCustomValidity&&e.setCustomValidity(""),"function"==typeof e.checkValidity&&(a=e.checkValidity()),e instanceof Element&&(e.tagName.match(/^input$/i)&&e.type.match(/^radio|checkbox/i)?n=e.checked:e.tagName.match(/^select/i)&&"selectedIndex"in e?n=e.options[e.selectedIndex].value:Composite.ATTRIBUTE_VALUE in e&&(n=e[Composite.ATTRIBUTE_VALUE])),o.attributes.hasOwnProperty(Composite.ATTRIBUTE_VALIDATE)&&!0===a&&!0!==t&&"function"==typeof i.model[Composite.ATTRIBUTE_VALIDATE]){var p=i.model[Composite.ATTRIBUTE_VALIDATE];a=void 0!==n?p.call(i.model,e,n):p.call(i.model,e)}if(!0!==a)"string"==typeof a&&a.trim()&&(s=a.trim()),"string"!=typeof s&&(o.attributes.hasOwnProperty(Composite.ATTRIBUTE_MESSAGE)&&(s=o.attributes[Composite.ATTRIBUTE_MESSAGE]||""),(s||"").match(Composite.PATTERN_EXPRESSION_CONTAINS)&&(s=String(Expression.eval(r+":"+Composite.ATTRIBUTE_MESSAGE,s)))),s&&"function"==typeof e.setCustomValidity&&(e.setCustomValidity(s),o.attributes.hasOwnProperty(Composite.ATTRIBUTE_NOTIFICATION)&&"function"==typeof e.reportValidity&&e.reportValidity());if(void 0!==a)return a}}},Composite.mount=function(e,t){if(Composite.mount.queue=Composite.mount.queue||[],Composite.mount.lock&&Composite.mount.lock!=t)Composite.mount.queue.includes(e)||Composite.mount.queue.push(e);else{t=Composite.lock(Composite.mount,e);try{if("string"==typeof e){if(!(e=e.trim()))return;return void document.querySelectorAll(e).forEach(e=>{Composite.mount(e,t.share())})}if(!(e instanceof Element)||Composite.mount.queue.includes(e)||e.nodeName.match(Composite.PATTERN_ELEMENT_IGNORE))return;if(Composite.mount.stack=Composite.mount.stack||[],Composite.mount.stack.includes(e))return;var r=e.ordinal(),o=Composite.render.meta[r];if(!(o instanceof Object))return;var a=o.attributes.hasOwnProperty(Composite.ATTRIBUTE_EVENTS)?o.attributes[Composite.ATTRIBUTE_EVENTS]:"";a=(a=a.toLowerCase().split(/\s+/)).filter((e,t,r)=>Composite.PATTERN_EVENT_FILTER.includes(e)&&r.indexOf(e)==t);var i=Composite.mount.lookup(e);if(i instanceof Object){var n=i.model;for(var s in void 0!==i.property&&(n="object"==typeof i.property?i.property:null),n)"function"==typeof n[s]&&s.match(Composite.PATTERN_EVENT_FUNCTIONS)&&(s=s.substring(2).toLowerCase(),a.includes(s)||a.push(s));for(var p=n?Object.getPrototypeOf(n):null;p;)Object.getOwnPropertyNames(p).forEach(e=>{"function"==typeof n[e]&&e.match(Composite.PATTERN_EVENT_FUNCTIONS)&&(e=e.substring(2).toLowerCase(),a.includes(e)||a.push(e))}),p=Object.getPrototypeOf(p)}Composite.mount.stack.push(e),a.forEach(t=>{e.addEventListener(t.toLowerCase(),e=>{var t=e.currentTarget,r=t.ordinal(),o=Composite.render.meta[r],a=e.type.toLowerCase();if(Composite.PATTERN_EVENT_FILTER.includes(a)){var i;a=Composite.PATTERN_EVENT_FILTER.indexOf(a),a=Composite.PATTERN_EVENT_NAMES[a];var n,s=!0,p=Composite.mount.lookup(t);if(p instanceof Object)if(t instanceof Element&&(t.tagName.match(/^input$/i)&&t.type.match(/^radio|checkbox/i)?n=t.checked:t.tagName.match(/^select/i)&&"selectedIndex"in t?n=t.options[t.selectedIndex].value:Composite.ATTRIBUTE_VALUE in t&&(n=t[Composite.ATTRIBUTE_VALUE])),!0===(s=Composite.validate(t,!1))){var l=e=>{var t=typeof e;return void 0!==e&&("object"===t&&null==e||("boolean"===t||"number"===t||"string"===t))};l(p.property)?p.property=n:"object"==typeof p.property?l(p.property.value)&&(p.property.value=n):void 0===p.property&&l(p.model.value)&&(p.model.value=n);var c=p.model;void 0!==p.property&&(c=p.property&&"object"==typeof p.property?p.property:null),c&&"function"==typeof c["on"+a]&&(i=c["on"+a].call(c,e))}var u=o.attributes.hasOwnProperty(Composite.ATTRIBUTE_EVENTS)?o.attributes[Composite.ATTRIBUTE_EVENTS]:"";if((u=u.toLowerCase().split(/\s+/)).includes(a.toLowerCase())){var T=o.attributes.hasOwnProperty(Composite.ATTRIBUTE_RENDER)?o.attributes[Composite.ATTRIBUTE_RENDER]:"";(T||"").match(Composite.PATTERN_EXPRESSION_CONTAINS)&&(T=Expression.eval(r+":"+Composite.ATTRIBUTE_RENDER,T)),Composite.render(T)}return p instanceof Object&&((void 0!==i&&!i||void 0!==s&&!0!==s)&&e.preventDefault(),void 0!==i)?i:void 0}})})}finally{t.release()}}},Composite.mount.locate=function(e){if(!(e instanceof Element))return null;var t=(e.getAttribute(Composite.ATTRIBUTE_ID)||"").trim();if(e.hasAttribute(Composite.ATTRIBUTE_COMPOSITE)){if(t.match(Composite.PATTERN_COMPOSITE_ID))return{composite:t,model:t};throw new Error("Invalid composite id"+(t?": "+t:""))}var r={composite:null,model:null,property:null,name:null};(t=t.match(Composite.PATTERN_ELEMENT_ID))&&(t[1]&&(r.property=t[1]),t[2]&&(r.name=t[2].replace(/(^:+)|(:+$)/g,"")));for(var o=e.parentNode;o;o=o.parentNode)if(o instanceof Element&&o.hasAttribute(Composite.ATTRIBUTE_ID)){if(!(t=(o.getAttribute(Composite.ATTRIBUTE_ID)||"").trim()).match(Composite.PATTERN_ELEMENT_ID))throw new Error("Invalid element id"+(t?": "+t:""));if(r.model?r.model=t+"."+r.model:r.model=t,o.hasAttribute(Composite.ATTRIBUTE_COMPOSITE)){if(!t.match(Composite.PATTERN_COMPOSITE_ID))throw new Error("Invalid composite id"+(t?": "+t:""));r.composite=t;break}}return r.composite?(r.name||delete r.name,r):null},Composite.mount.lookup=function(e){if(!(e instanceof Element))return null;var t,r=Composite.mount.locate(e);if(!r)return null;if(!(t={meta:r,composite:Object.lookup(r.composite),model:Object.lookup(r.model)}).composite||!t.model)return null;if(void 0===r.property)return t;if(r.name){var o=(r.property+"."+r.name.replace(/\:/g,".")).match(/^(.*)\.(\w+)$/);r.property=o[1],r.name=o[2]}return(t={meta:r,composite:Object.lookup(r.composite),model:Object.lookup(r.model),get property(){if(this.meta.name){var e=Object.lookup(this.model,this.meta.property);if(null==e)return;return e[this.meta.name]}return this.model[this.meta.property]},set property(e){this.meta.name?Object.lookup(this.model,this.meta.property)[this.meta.name]=e:this.model[this.meta.property]=e}}).composite&&t.model&&void 0!==t.property?t:null},Composite.customize=function(e){var t=arguments.length>0?arguments[0]:void 0;if("string"==typeof t&&arguments.length>1&&"string"==typeof arguments[1]&&t.match(/^@ATTRIBUTES-STATICS$/i)){var r=[];(arguments[1]||"").trim().split(/\s+/).forEach(e=>{e=e.toLowerCase(),Composite.statics.has(e)||e.match(Composite.PATTERN_ATTRIBUTE_ACCEPT)||(Composite.statics.add(e),r.push(e))});var o=e=>{if(e instanceof Element){var t=e.ordinal(),a=Composite.render.meta[t];a&&(r.forEach(t=>{a.statics=a.statics||{},a.statics.hasOwnProperty[t]&&void 0!==a.statics[t]||(e.hasAttribute(t)?a.statics[t]=e.getAttribute(t):a.statics[t]=null)}),Array.from(e.childNodes).forEach(e=>{o(e)}))}};o(document.body)}else if("function"!=typeof t||1!=arguments.length){if("string"!=typeof t)throw new TypeError("Invalid scope: "+typeof t);var a=arguments.length>1?arguments[1]:null;if("function"!=typeof a&&null!=a)throw new TypeError("Invalid callback: "+typeof a);if((t=t.trim()).length<=0)throw new Error("Invalid scope");if(t.match(Composite.PATTERN_CUSTOMIZE_SCOPE))null==a?Composite.macros.delete(t.toLowerCase()):Composite.macros.set(t.toLowerCase(),a);else{var i=t.toLowerCase().hashCode();null==a?Composite.selectors.delete(i):Composite.selectors.set(i,{selector:t,callback:a})}}else Composite.acceptors.add(t)},Composite.render=function(e,t){if(e)if(Composite.render.queue=Composite.render.queue||[],Composite.render.lock&&Composite.render.lock!=t)Composite.render.queue.includes(e)||Composite.render.queue.push(e);else{t=Composite.lock(Composite.render,e);try{if("string"==typeof e){if(!(e=e.trim()))return;return void(o=document.querySelectorAll(e)).forEach(e=>{Composite.render(e,t.share())})}if(!(e instanceof Node))return;var r=Composite.macros.get(e.nodeName.toLowerCase());if(r&&!1===r(e))return;if(e.parentNode)for(let[t,r]of Composite.selectors){var o=e.parentNode.querySelectorAll(r.selector);if(Array.from(o).includes(e)&&!1===r.callback(e))return}Composite.render.meta=Composite.render.meta||[];var a=e.ordinal();if(!(u=Composite.render.meta[a])&&(Composite.acceptors.forEach(t=>{t.call(null,e)}),u={serial:a,element:e,attributes:{}},Composite.render.meta[a]=u,e instanceof Element&&e.attributes)){Array.from(e.attributes).forEach(t=>{((t={name:t.name.toLowerCase(),value:(t.value||"").trim()}).value.match(Composite.PATTERN_EXPRESSION_CONTAINS)||t.name.match(Composite.PATTERN_ATTRIBUTE_ACCEPT)||Composite.statics.has(t.name))&&(!t.name.match(Composite.PATTERN_ATTRIBUTE_ACCEPT)||t.name.match(Composite.PATTERN_ATTRIBUTE_STATIC)||Composite.statics.has(t.name)||t.name==Composite.ATTRIBUTE_RELEASE||e.removeAttribute(t.name),u.attributes[t.name]=t.value,t.value.match(Composite.PATTERN_EXPRESSION_CONTAINS)&&(t.name.match(Composite.PATTERN_ATTRIBUTE_STATIC)||t.name==Composite.ATTRIBUTE_ID||t.name==Composite.ATTRIBUTE_EVENTS||Composite.statics.has(t.name))&&(t.value=Expression.eval(e.ordinal()+":"+t.name,t.value)),(t.name.match(Composite.PATTERN_ATTRIBUTE_STATIC)||t.name==Composite.ATTRIBUTE_ID||t.name==Composite.ATTRIBUTE_EVENTS)&&(u.attributes[t.name]=t.value),u.statics=u.statics||{},Composite.statics.has(t.name)&&(u.statics[t.name]=t.value),(t.name.match(Composite.PATTERN_ATTRIBUTE_STATIC)||t.name==Composite.ATTRIBUTE_ID||t.name==Composite.ATTRIBUTE_EVENTS||Composite.statics.has(t.name))&&e.setAttribute(t.name,t.value))});var i=u.attributes.hasOwnProperty(Composite.ATTRIBUTE_CONDITION)?u.attributes[Composite.ATTRIBUTE_CONDITION]:null;if(delete u.attributes[Composite.ATTRIBUTE_CONDITION],i){delete u.attributes[Composite.ATTRIBUTE_CONDITION];var n=document.createTextNode("");u={serial:n.ordinal(),element:n,attributes:u.attributes,condition:i,template:e.cloneNode(!0),output:null,complete:!1,share:null},Composite.render.meta[u.serial]=u,delete Composite.render.meta[a],e.parentNode.replaceChild(n,e),a=(e=n).ordinal(),u=Composite.render.meta[a]}else u.attributes.hasOwnProperty(Composite.ATTRIBUTE_COMPOSITE)&&Composite.render.include(e)}if(u.hasOwnProperty("placeholder"))return Composite.render(u.placeholder.element,t.share()),e=u.placeholder.element,a=e.ordinal(),void(u=Composite.render.meta[a]);if(e.nodeType==Node.TEXT_NODE&&!u.hasOwnProperty(Composite.ATTRIBUTE_CONDITION)){if(e.parentNode&&e.parentNode.nodeName.match(Composite.PATTERN_ELEMENT_IGNORE))return;if(u.attributes.hasOwnProperty(Composite.ATTRIBUTE_TEXT))return;if(u.attributes.hasOwnProperty(Composite.ATTRIBUTE_VALUE))return void u.render();if((f=e.textContent).match(Composite.PATTERN_EXPRESSION_CONTAINS)){if((f=f.replace(Composite.PATTERN_EXPRESSION_CONTAINS,(e,t,r)=>{if(!e.substring(2,e.length-2).trim())return"";var o=document.createTextNode(""),a=o.ordinal(),i={serial:a,element:o,attributes:{},value:null,render(){if(this.attributes.hasOwnProperty(Composite.ATTRIBUTE_NAME)){var e=(this.attributes[Composite.ATTRIBUTE_NAME]||"").trim(),t=(this.attributes[Composite.ATTRIBUTE_VALUE]||"").trim();window[e]=Expression.eval(this.serial+":"+Composite.ATTRIBUTE_VALUE,t),word=""}else word=this.attributes[Composite.ATTRIBUTE_VALUE],word=Expression.eval(this.serial+":"+Composite.ATTRIBUTE_VALUE,word);this.value=word,this.element.textContent=word}},n=e.match(Composite.PATTERN_EXPRESSION_VARIABLE);return n?(i.attributes[Composite.ATTRIBUTE_NAME]=n[1],i.attributes[Composite.ATTRIBUTE_VALUE]="{{"+n[2]+"}}"):i.attributes[Composite.ATTRIBUTE_VALUE]=e,Composite.render.meta[a]=i,"{{"+a+"}}"})).match(Composite.PATTERN_EXPRESSION_CONTAINS)){var s=f.split(/(\{\{\d+\}\})/);if(s.forEach((e,t,r)=>{if(e.match(/^\{\{\d+\}\}$/)){var o=parseInt(e.substring(2,e.length-2).trim());(a=Composite.render.meta[o]).render()}else{var a,i=document.createTextNode(e);(a={serial:o=i.ordinal(),element:i,attributes:{}}).element.textContent=e,a.attributes[Composite.ATTRIBUTE_TEXT]=e,Composite.render.meta[o]=a}r[t]=a.element}),null==e.parentNode)return;return s.forEach(t=>{e.parentNode.insertBefore(t,e)}),void e.parentNode.removeChild(e)}e.nodeValue=f}return void(u.attributes[Composite.ATTRIBUTE_TEXT]=f)}var p,l=e=>{if(!(e instanceof Element))return null;for(var t=document.createElement("div"),r=t;e;e=e.parentNode)if(e instanceof Element&&e.hasAttribute(Composite.ATTRIBUTE_ID)){var o=document.createElement("div");o.setAttribute(Composite.ATTRIBUTE_ID,e.getAttribute(Composite.ATTRIBUTE_ID)),e.hasAttribute(Composite.ATTRIBUTE_COMPOSITE)&&o.setAttribute(Composite.ATTRIBUTE_COMPOSITE,""),o.appendChild(r),r=o}return t},c=e=>{"string"!=typeof e||Composite.models.has(e)||(Composite.models.add(e),(e=Object.lookup(e))&&"function"==typeof e.dock&&e.dock.call(e))};if(e instanceof Element&&u.attributes.hasOwnProperty(Composite.ATTRIBUTE_COMPOSITE)){if(!(T=(u.attributes[Composite.ATTRIBUTE_ID]||"").trim()).match(Composite.PATTERN_COMPOSITE_ID))throw new Error("Invalid composite id"+(T?": "+T:""));c(T)}if(e.nodeType==Node.TEXT_NODE&&u.hasOwnProperty(Composite.ATTRIBUTE_CONDITION)){if((n=u).share==t.ordinal())return;if(n.share=t.ordinal(),!n.condition||!n.condition.match(Composite.PATTERN_EXPRESSION_CONDITION)||!0!==Expression.eval(a+":"+Composite.ATTRIBUTE_CONDITION,n.condition)){if((i=(n.condition||"").trim()).match(Composite.PATTERN_EXPRESSION_CONDITION)||console.error("Invalid condition"+(i?": "+i:"")),!n.output)return;return e.parentNode.removeChild(n.output),void delete n.output}if(!n.complete){if(n.attributes.hasOwnProperty(Composite.ATTRIBUTE_COMPOSITE)){var u={serial:a=n.template.ordinal(),element:n.template,attributes:n.attributes,share:null};Composite.render.meta[a]=u,Composite.render.include(n.template),delete Composite.render.meta[a]}n.complete=!0}if(n.attributes.hasOwnProperty(Composite.ATTRIBUTE_COMPOSITE)){var T;if(!(T=(n.attributes[Composite.ATTRIBUTE_ID]||"").trim()).match(Composite.PATTERN_COMPOSITE_ID))throw new Error("Invalid composite id"+(T?": "+T:""));c(T)}if(!n.output){var m=n.template.cloneNode(!0);l(e.parentNode).appendChild(m),n.output=m;u={serial:a=m.ordinal(),element:m,attributes:u.attributes};return Composite.render.meta[a]=u,Composite.render(m,t.share()),u.placeholder=n,void e.parentNode.insertBefore(m,e)}e=n.output,a=e.ordinal(),u=Composite.render.meta[a]}if(!(e instanceof Element))return;if(u.attributes.hasOwnProperty(Composite.ATTRIBUTE_IMPORT))if(e.innerHTML="",((p=u.attributes[Composite.ATTRIBUTE_IMPORT])||"").match(Composite.PATTERN_EXPRESSION_CONTAINS)&&(p=Expression.eval(a+":"+Composite.ATTRIBUTE_IMPORT,p)),Composite.render.cache=Composite.render.cache||{},p)if(p instanceof Element||p instanceof NodeList)e.appendChild(p,!0),delete u.attributes[Composite.ATTRIBUTE_IMPORT];else if(String(p).match(Composite.PATTERN_DATASOURCE_URL)){var E;(E=String(p).match(Composite.PATTERN_DATASOURCE_URL))[2]=DataSource.fetch("xslt://"+(E[2]||E[1])),E[1]=DataSource.fetch("xml://"+E[1]),E=DataSource.transform(E[1],E[2]),e.appendChild(E,!0);a=e.ordinal();delete(u=Composite.render.meta[a]).attributes[Composite.ATTRIBUTE_IMPORT]}else if(void 0!==Composite.render.cache[p]){e.innerHTML=Composite.render.cache[p];a=e.ordinal();delete(u=Composite.render.meta[a]).attributes[Composite.ATTRIBUTE_IMPORT]}else Composite.asynchron((e,t,r)=>{try{var o=new XMLHttpRequest;if(o.overrideMimeType("text/plain"),o.open("GET",r,!1),o.send(),"200"!=o.status)throw new Error("HTTP status "+o.status+" for "+o.responseURL);var a=o.responseText.trim();Composite.render.cache[o.responseURL]=a,e.innerHTML=a;var i=e.ordinal();delete Composite.render.meta[i].attributes[Composite.ATTRIBUTE_IMPORT]}catch(e){throw Composite.fire(Composite.EVENT_HTTP_ERROR,e),e}finally{t.release()}},e,t.share(),p);else delete u.attributes[Composite.ATTRIBUTE_IMPORT];if(u.attributes.hasOwnProperty(Composite.ATTRIBUTE_OUTPUT))if(e.innerHTML="",((p=u.attributes[Composite.ATTRIBUTE_OUTPUT])||"").match(Composite.PATTERN_EXPRESSION_CONTAINS)&&(p=Expression.eval(a+":"+Composite.ATTRIBUTE_OUTPUT,p)),String(p).match(Composite.PATTERN_DATASOURCE_URL))(E=String(p).match(Composite.PATTERN_DATASOURCE_URL))[2]=DataSource.fetch("xslt://"+(E[2]||E[1])),E[1]=DataSource.fetch("xml://"+E[1]),E=DataSource.transform(E[1],E[2]),e.appendChild(E,!0);else p instanceof Node?e.appendChild(p.cloneNode(!0),!0):p instanceof NodeList?Array.from(p).forEach(function(t,r){e.appendChild(t.cloneNode(!0),0==r)}):e.innerHTML=String(p);var d=u.attributes[Composite.ATTRIBUTE_INTERVAL];if(d&&!u.interval){d=String(d).trim();var h=a+":"+Composite.ATTRIBUTE_INTERVAL;(d=String(Expression.eval(h,d))).match(/^\d+$/)?(u.hasOwnProperty("placeholder")&&(u=u.placeholder,e=u.element),d=parseInt(d),u.interval={object:u,selector:e,task(e){var t=e.selector.ordinal(),r=Composite.render.meta[t],o=!document.body.contains(e.selector);r||(o=!0),!r||!r.hasOwnProperty(Composite.ATTRIBUTE_CONDITION)||r.condition.element&&document.body.contains(r.condition.element)||(o=!0),o?(window.clearInterval(e.timer),delete e.object.interval):Composite.render(e.selector)}},u.interval.timer=window.setInterval(u.interval.task,d,u.interval)):d&&console.error("Invalid interval: "+d)}if(u.attributes.hasOwnProperty(Composite.ATTRIBUTE_ITERATE)){if(!u.iterate){var f,A=u.attributes[Composite.ATTRIBUTE_ITERATE];(f=A.match(Composite.PATTERN_EXPRESSION_VARIABLE))?(u.iterate={name:f[1].trim(),expression:"{{"+f[2].trim()+"}}"},u.template=e.cloneNode(!0)):console.error("Invalid iterate: "+A)}if(u.iterate){var w=window[u.iterate.name];try{h=a+":"+Composite.ATTRIBUTE_ITERATE;if(e.innerHTML="",A=Expression.eval(h,u.iterate.expression)){if(A instanceof XPathResult){for(var C={entry:null,array:[],iterate:A};C.entry=C.iterate.iterateNext();)C.array.push(C.entry);A=C.array}else A=Array.from(A);A.forEach((r,o,a)=>{var i={};Object.defineProperty(i,"item",{value:r,enumerable:!0}),Object.defineProperty(i,"index",{value:o,enumerable:!0}),Object.defineProperty(i,"data",{value:a,enumerable:!0}),window[u.iterate.name]=i;var n=document.createElement("div");l(e.parentNode).appendChild(n),n.appendChild(u.template.cloneNode(!0).childNodes),Composite.render(n,t.share()),e.appendChild(n.childNodes),delete Composite.render.meta[n.ordinal()]})}}finally{delete window[u.iterate.name],void 0!==w&&(window[u.iterate.name]=w)}}}if(!e.nodeName.match(Composite.PATTERN_ELEMENT_IGNORE)){var g=[];for(var v in u.attributes)u.attributes.hasOwnProperty(v)&&g.push(v);Composite.ATTRIBUTE_VALUE in e&&u.attributes.hasOwnProperty(Composite.ATTRIBUTE_VALUE)&&!g.includes(Composite.ATTRIBUTE_VALUE)&&g.push(Composite.ATTRIBUTE_VALUE),g.forEach(t=>{if(!t.match(Composite.PATTERN_ATTRIBUTE_ACCEPT)||t.match(Composite.PATTERN_ATTRIBUTE_STATIC)){var r=u.attributes[t]||"";if(r.match(Composite.PATTERN_EXPRESSION_CONTAINS)){var o=a+":"+t;void 0!==(r=Expression.eval(o,r))?(r=(r=String(r).encodeHtml()).replace(/"/g,"&quot;"),t.toLowerCase()==Composite.ATTRIBUTE_VALUE&&Composite.ATTRIBUTE_VALUE in e&&(e.value=r),e.setAttribute(t,r)):e.removeAttribute(t)}}})}if(e.nodeName.match(Composite.PATTERN_SCRIPT))if((e.getAttribute(Composite.ATTRIBUTE_TYPE)||"").trim().match(Composite.PATTERN_COMPOSITE_SCRIPT))try{Composite.render.include.eval(e.textContent)}catch(e){console.error("Composite JavaScript",e)}!e.childNodes||e.nodeName.match(Composite.PATTERN_ELEMENT_IGNORE)||u.attributes.hasOwnProperty(Composite.ATTRIBUTE_ITERATE)||Array.from(e.childNodes).forEach(r=>{e.contains(r)&&Composite.render(r,t.share())}),e.hasAttribute(Composite.ATTRIBUTE_RELEASE)&&e.removeAttribute(Composite.ATTRIBUTE_RELEASE)}finally{t.release()}}},Composite.render.include=function(e){if(!("string"==typeof e||e instanceof Element))throw new TypeError("Invalid composite: "+typeof e);var t=null;if(e instanceof Element){if(!e.hasAttribute(Composite.ATTRIBUTE_ID))throw new Error("Unknown composite without id");if(!(t=Composite.render.meta[e.ordinal()]))throw new Error("Unknown composite")}Composite.render.cache=Composite.render.cache||{};var r=Composite.MODULES+"/"+(e instanceof Element?e.id:e);if(void 0===Composite.render.cache[r+".composite"]){Composite.render.cache[r+".composite"]=null;var o=t=>{var r=new XMLHttpRequest;if(r.overrideMimeType("text/plain"),r.open("HEAD",t,!1),r.send(),404!=r.status){if("200"!=r.status)throw new Error("HTTP status "+r.status+" for "+r.responseURL);if(r.open("GET",t,!1),r.send(),404!=r.status){if("200"!=r.status)throw new Error("HTTP status "+r.status+" for "+r.responseURL);var o=r.responseText.trim();if(o){var a=document.createElement("a");if(a.href=r.responseURL,Composite.render.cache[a.pathname]=o,r.responseURL.match(/\.css$/)){var i=document.querySelector("html head");if(!i)throw new Error("No head element found");var n=document.createElement("style");n.setAttribute("type","text/css"),n.textContent=o,i.appendChild(n)}else if(r.responseURL.match(/\.js$/))try{Composite.render.include.eval(o)}catch(e){throw console.error(r.responseURL,e.name+": "+e.message),e}else r.responseURL.match(/\.html$/)&&e instanceof Element&&(e.innerHTML=o)}}}};o(r+".css"),o(r+".js"),!t||t.attributes.hasOwnProperty(Composite.ATTRIBUTE_IMPORT)||t.attributes.hasOwnProperty(Composite.ATTRIBUTE_OUTPUT)||e.innerHTML.trim()||o(r+".html")}else void 0!==Composite.render.cache[r+".html"]&&(!t||t.attributes.hasOwnProperty(Composite.ATTRIBUTE_IMPORT)||t.attributes.hasOwnProperty(Composite.ATTRIBUTE_OUTPUT)||e.innerHTML.trim()||e instanceof Element&&(e.innerHTML=Composite.render.cache[r+".html"]))},Composite.render.include.eval=function(script){for(script=script.split(/[\r\n]+/);script&&script.length>0&&script[0].match(/(^\s*(#import(\s+.*)*)*$)/);){var line=script.shift().replace(/^\s*#import(\s+|$)/,"");line.split(/\s+/).forEach(e=>{e&&Composite.render.include(e)})}script=script.join("\r\n").trim(),script&&eval(script)},window.addEventListener("error",e=>{Composite.fire(Composite.EVENT_ERROR,e)}),window.addEventListener("load",e=>{if(document.querySelector("html")){document.querySelector("html head")||document.querySelector("html").appendChild(document.createElement("head"));var t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML="*[release] {display:none!important;}",document.querySelector("html head").appendChild(t)}Composite.render.include("common"),new MutationObserver(e=>{e.forEach(e=>{if(Composite.render.meta){var t=e.target.ordinal(),r=Composite.render.meta[t];if("characterData"!=e.type||e.target.nodeType!=Node.TEXT_NODE){if(r&&"attributes"==e.type){var o=(e.attributeName||"").toLowerCase().trim();o.match(Composite.PATTERN_ATTRIBUTE_ACCEPT)&&!o.match(Composite.PATTERN_ATTRIBUTE_STATIC)?e.target.hasAttribute(o)&&e.target.removeAttribute(o):o.match(Composite.PATTERN_ATTRIBUTE_STATIC)?r.attributes.hasOwnProperty(o)?e.target.hasAttribute(o)&&r.attributes[o]===e.target.getAttribute(o)||e.target.setAttribute(o,r.attributes[o]):e.target.hasAttribute(o)&&e.target.removeAttribute(o):Composite.statics.has(o)&&(r.statics=r.statics||{},r.statics.hasOwnProperty(o)?e.target.hasAttribute(o)&&r.statics[o]===e.target.getAttribute(o)||e.target.setAttribute(o,r.statics[o]):e.target.hasAttribute(o)&&e.target.removeAttribute(o))}e.addedNodes&&e.addedNodes.forEach(e=>{(e instanceof Element||e instanceof Node&&e.nodeType==Node.TEXT_NODE)&&!Composite.render.meta[e.ordinal()]&&document.body.contains(e)&&Composite.render(e)}),e.removedNodes&&e.removedNodes.forEach(e=>{var t=e=>{e.childNodes&&Array.from(e.childNodes).forEach(e=>{t(e)});var r=e.ordinal(),o=Composite.render.meta[r];if(o&&o.attributes.hasOwnProperty(Composite.ATTRIBUTE_COMPOSITE)){var a=Composite.mount.lookup(e);a&&a.meta&&a.meta.model&&a.model&&Composite.models.has(a.meta.model)&&(Composite.models.delete(a.meta.model),"function"==typeof a.model.undock&&a.model.undock.call(a.model))}delete Composite.render.meta[e.ordinal()]};t(e)})}else r&&r.hasOwnProperty(Composite.ATTRIBUTE_VALUE)&&String(r.value||"")!=e.target.textContent&&(e.target.textContent=r.value||"")}})}).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!0})})),"undefined"==typeof Expression&&(window.Expression={get TYPE_TEXT(){return 1},get TYPE_EXPRESSION(){return 2},get TYPE_LITERAL(){return 3},get TYPE_SCRIPT(){return 4},get TYPE_KEYWORD(){return 5},get TYPE_OTHER(){return 6},get TYPE_METHOD(){return 7},get TYPE_VALUE(){return 8},get TYPE_LOGIC(){return 9}},Object.defineProperty(Expression,"cache",{value:new Map}),Expression.lookup=function(context,expression){try{if("string"==typeof context&&void 0===expression)return context.match(/^#[a-zA-Z]\w*$/)?document.querySelector(context):context.match(/^(#[a-zA-Z]\w*)\.(.*)*$/)?(expression=context.match(/^(#[a-zA-Z]\w*)\.(.*)*$/),Expression.lookup(document.querySelector(expression[1]),expression[2])):context.indexOf(".")<0?eval(context):(expression=context.match(/^(.*?)\.(.*)$/),Expression.lookup(eval(expression[1]),expression[2]));expression=expression.indexOf(".")<0?[null,expression]:expression.match(/^(.*?)\.(.*)$/);var method="get"+expression[1].capitalize();return"function"!=typeof context[method]&&(method="is"+expression[1].capitalize()),"function"==typeof context[method]?(context=context[method](),expression.length>2?Expression.lookup(context,expression[2]):context):(context=context[expression[1]],expression.length>2?Expression.lookup(context,expression[2]):context)}catch(e){return}},Expression.parse=function(e){if(""===(e=null==e?"":e.trim()))return"";var t={words:[],text:[],expression:[],literal:[],script:[],keyword:[],other:[],value:[],method:[],logic:[]};if((e=(e=(e=(e=e.replace(/(^[\r\n]+)|([\r\n]+$)/g,"")).replace(/[\r\n]/g," ")).replace(/(\{\{)/g,"\n$1")).replace(/(\}\})/g,"$1\n")).indexOf("\n")<0)return'"'+e+'"';e=e.replace(/(^\n+)|(\n+$)/g,"");var r=e=>{e.type==Expression.TYPE_TEXT?t.text.push(e):e.type==Expression.TYPE_EXPRESSION?t.expression.push(e):e.type==Expression.TYPE_SCRIPT?t.script.push(e):e.type==Expression.TYPE_LITERAL?t.literal.push(e):e.type==Expression.TYPE_KEYWORD?t.keyword.push(e):e.type==Expression.TYPE_OTHER?t.other.push(e):e.type==Expression.TYPE_VALUE?t.value.push(e):e.type==Expression.TYPE_METHOD?t.method.push(e):e.type==Expression.TYPE_LOGIC&&t.logic.push(e)};e.split(/\n/).forEach(e=>{var o={type:Expression.TYPE_TEXT,data:e};e.match(/^\{\{.*\}\}$/)?(o.data=o.data.substring(2,o.data.length-2),o.type=Expression.TYPE_EXPRESSION):o.data='"'+o.data.replace(/\\/,"\\\\").replace(/"/,'\\"')+'"',r(o),t.words.push(o)}),t.expression.forEach(e=>{var t=e.data;t=(t=t.replace(/(^|[^\\])((?:\\{2})*)(\\[\'])/g,"$1$2\\u0027")).replace(/(^|[^\\])((?:\\{2})*)(\\[\"])/g,"$1$2\\u0022");for(var o=[],a=/(^.*?)(([\'\"]).*?(\3|$))/m;t.match(a);)t=t.replace(a,(e,t,a)=>(t={type:Expression.TYPE_SCRIPT,data:t},r(t),o.push(t),a={type:Expression.TYPE_LITERAL,data:a},r(a),o.push(a),""));t.length>0&&(t={type:Expression.TYPE_SCRIPT,data:t},r(t),o.push(t)),e.data=o});var o=["and","&&","or","||","not","!","eq","==","ne","!=","lt","<","gt",">","le","<=","ge",">=","empty","!","div","/","mod","%"];t.script.forEach(e=>{for(var t=e.data,a=0;a<o.length;a+=2){var i=new RegExp("(^|[^\\w\\.])("+o[a]+")(?=[^\\w\\.]|$)","ig");t=t.replace(i,"$1\n\r"+o[a+1]+"\n")}t=t.replace(/(^|[^\w\.])(true|false|null|instanceof|typeof|undefined|new)(?=[^\w\.]|$)/gi,(e,t,r)=>t+"\n\r"+r.toLowerCase()+"\n");var n=[];t.split(/\n/).forEach(e=>{var t={type:Expression.TYPE_OTHER,data:e};e.match(/^\r/)&&(t.data=e.substring(1),t.type=Expression.TYPE_KEYWORD),r(t),n.push(t)}),e.data=n}),t.other.forEach(e=>{var t=e.data;t=(t=t.replace(/(^|[^\w\.])(#{0,1}[a-zA-Z](?:[\w\.]{0,}[\w]){0,1}(?=(?:[^\w\(\.]|$)))/g,"$1\n\r\r$2\n")).replace(/(^|[^\w\.])(#{0,1}[a-zA-Z](?:[\w\.]{0,}\w){0,1})(?=\()/g,"$1\n\r$2\n");var o=[];t.split(/\n/).forEach(e=>{var t={type:Expression.TYPE_LOGIC,data:e};e.match(/^\r\r/)?(t.data='Expression.lookup("'+e.substring(2)+'")',t.type=Expression.TYPE_VALUE):e.match(/^\r[^\r]/)&&(t.data=e.substring(1),t.data.match(/^#[a-zA-Z]/)&&(t.data='Expression.lookup("'+t.data+'")'),t.type=Expression.TYPE_METHOD),r(t),o.push(t)}),e.data=o});var a=[],i=e=>{Array.isArray(e)?e.forEach(e=>{i(e)}):Array.isArray(e.data)?e.data.forEach(e=>{i(e)}):"string"==typeof e.data&&(e.data&&e.data.length?a.push(e):i(e.data))};i(t.words);var n="";return a.forEach(e=>{e.type==Expression.TYPE_TEXT?n+="\n"+e.data+"\r":e.type==Expression.TYPE_KEYWORD?n+=" "+e.data+" ":e.type!=Expression.TYPE_LITERAL&&e.type!=Expression.TYPE_VALUE&&e.type!=Expression.TYPE_METHOD&&e.type!=Expression.TYPE_LOGIC||(n+=e.data)}),(n=n.replace(/(^\n)|(\r$)/g,"")).match(/\r[^\n]*$/)&&(n+=")"),n.match(/^[^\r]*\n/)&&(n="("+n),n=(n=(n=(n=n.replace(/(\n\r)+/g," + ")).replace(/\r/g," + (")).replace(/\n/g,") + ")).replace(/(^\s*\+\s*)|(\s*\+\s*$)/,"")},Expression.eval=function(variants){var expression=null;arguments.length>1?expression=arguments[1]:arguments.length>0&&(expression=arguments[0]);var serial=null;arguments.length>1&&(serial=arguments[0]);var script=null;script=serial&&Expression.cache.get(serial)||null,script||(script=Expression.parse(expression)),Expression.cache.set(serial,script);try{return eval(script)}catch(e){return e.message+="\n\t"+script,console.error(e),e.message}}),"undefined"==typeof Path&&(window.Path={get PATTERN_PATH(){return/(?:^(?:\w(?:\-*\w)*)*(?:(?:#+\w(?:\-*\w)*)+)#*$)|(?:^\w(?:\-*\w)*$)|(?:^#+$)|(?:^$)/},get PATTERN_URL(){return/^\w+:\/.*?(#.*)*$/i},get PATTERN_PATH_FUNCTIONAL(){return/^#{3,}$/}},Path.normalize=function(e){if(arguments.length<=0)return null;if(arguments.length>0&&null==arguments[0])return null;if(arguments.length>1&&null==arguments[1])return null;if(arguments.length>1&&null!=arguments[0]&&"string"!=typeof arguments[0])throw new TypeError("Invalid root: "+typeof arguments[0]);var t="#";if(arguments.length>1){t=arguments[0];try{t=Path.normalize(t)}catch(e){throw t=(t||"").trim(),new TypeError("Invalid root"+(t?": "+t:""))}}if(arguments.length>1&&null!=arguments[1]&&"string"!=typeof arguments[1])throw new TypeError("Invalid path: "+typeof arguments[1]);if(arguments.length>0&&null!=arguments[0]&&"string"!=typeof arguments[0])throw new TypeError("Invalid path: "+typeof arguments[0]);var r="";if(1==arguments.length&&(r=arguments[0]),1==arguments.length&&r.match(Path.PATTERN_URL)?r=r.replace(Path.PATTERN_URL,"$1"):arguments.length>1&&(r=arguments[1]),!(r=(r||"").trim()).match(Path.PATTERN_PATH))throw new TypeError("Invalid path"+(String(r).trim()?": "+r:""));if((r=(r=r.replace(/([^#])#$/,"$1")).replace(/^([^#])/,"#$1")).match(Path.PATTERN_PATH_FUNCTIONAL))return"###";r=(r=t+r).toLowerCase();for(var o=/#[^#]+#{2}/;r.match(o);)r=r.replace(o,"#");return r="#"+r.replace(/(^#+)|(#+)$/g,"")}),"undefined"==typeof SiteMap&&(window.SiteMap={get PATTERN_PATH_FACE(){return/(^((#\w[\-\w]+\w)|(#\w+))+$)|(^#$)/},get PATTERN_PATH_FACET(){return/^((\w[\-\w]+\w)|(\w+))(#((\w[\-\w]+\w)|(\w+)))*$/},get PATTERN_PATH_FACET_VARIABLE(){return/(^((\w[\-\w]+\w)|(\w+))(#((\w[\-\w]+\w)|(\w+)))*(\.){3}$)|(^\.{3}$)/},get location(){if(SiteMap.history.size<=0)return window.location.hash||"#";var e=Array.from(SiteMap.history);return e[e.length-1]},set location(e){if(SiteMap.history.has(e))for(var t=Array.from(SiteMap.history.values());SiteMap.history.has(e)&&t.includes(e);){var r=t.pop();if(r==e)return;SiteMap.history.delete(r)}else SiteMap.history.add(e)}},Object.defineProperty(SiteMap,"paths",{value:new Map}),Object.defineProperty(SiteMap,"facets",{value:new Map}),Object.defineProperty(SiteMap,"variables",{value:new Set}),Object.defineProperty(SiteMap,"acceptors",{value:new Set}),Object.defineProperty(SiteMap,"history",{value:new Set}),SiteMap.permit=function(e){for(let t of SiteMap.acceptors)if((!t.pattern||t.pattern.test(e))&&!0!==(t=t.action.call(null,e)))return"string"==typeof t&&(t=Path.normalize(t)),t;return!0},SiteMap.locate=function(e){e=e||"";var t=e=>{var t=[SiteMap.location,e];return e.match(/(^#[^\#].*$)|(^#$)/)&&t.shift(),t};try{e=Path.normalize(...t(e))}catch(r){for(;;){e=e.replace(/(^[^#]+$)|(#[^#]*$)/,"");try{e=Path.normalize(...t(e))}catch(e){continue}break}}if(e.match(Path.PATTERN_PATH_FUNCTIONAL))return e;var r=Array.from(SiteMap.paths.keys());for(r=r.concat(Array.from(SiteMap.facets.keys()));r&&e.length>1;){for(let t of SiteMap.variables)if((e+"#").startsWith(t+"#"))return e;if(r.includes(e))return e;e=Path.normalize(e+"##")}return"#"},SiteMap.navigate=function(e){Composite.asynchron(e=>{window.location.hash=e},SiteMap.locate(e)),SiteMap.locate(e)},SiteMap.forward=function(e){var t=document.createEvent("HTMLEvents");t.initEvent("hashchange",!1,!0),t.newURL=e,window.dispatchEvent(t)},SiteMap.lookup=function(e){arguments.length<=0&&(e=SiteMap.location);for(let r of SiteMap.variables)if((e+"#").startsWith(r+"#")){if(SiteMap.paths.has(r))return{path:e,face:r,facet:null,get data(){return e.substring(r.length)||null}};if(SiteMap.facets.has(r)){var t=SiteMap.facets.get(r);return{path:e,face:t.path,facet:t.facet,get data(){return e.substring(t.path.length+t.facet.length)||null}}}break}return SiteMap.paths.has(e)?{path:e,face:e,facet:null}:SiteMap.facets.has(e)?{path:(e=>e.facet?e.path.endsWith("#")?e.path+e.facet:e.path+"#"+e.facet:e.path)(t=SiteMap.facets.get(e)),face:t.path,facet:t.facet}:null},SiteMap.accept=function(e){if(!(e=(e||"").trim().toLowerCase()).match(/^#.*$/))return!1;e=e.replace(/(#.*?)#*$/,"$1");var t=SiteMap.lookup(Path.normalize(SiteMap.location));if(!t)return!1;var r=SiteMap.lookup(e);if(!r)return!1;var o=r.path;return o.endsWith("#")||(o+="#"),!(r.facet&&t.face!=r.face&&!t.path.startsWith(o))&&!(!t.path.startsWith(o)&&t.face!=r.face)},SiteMap.customize=function(e){if(arguments.length>1&&arguments[0]instanceof RegExp){if("function"!=typeof arguments[1])throw new TypeError("Invalid acceptor: "+typeof arguments[1]);SiteMap.acceptors.add({pattern:arguments[0],action:arguments[1]})}else{if(arguments.length<1||"object"!=typeof arguments[0])throw new TypeError("Invalid map: "+typeof arguments[0]);var t=arguments[0],r=new Set(SiteMap.acceptors);if(arguments.length>1){if("function"!=typeof arguments[1])throw new TypeError("Invalid permit: "+typeof arguments[1]);r.add({pattern:null,action:arguments[1]})}var o=new Map;SiteMap.paths.forEach((e,t,r)=>{"string"==typeof t&&t.match(SiteMap.PATTERN_PATH_FACE)&&o.set(t,e)});var a=new Map;SiteMap.facets.forEach((e,t,r)=>{"string"==typeof t&&t.match(SiteMap.PATTERN_PATH_FACET)&&a.set(t,e)});var i=new Set;SiteMap.variables.forEach(e=>{"string"==typeof e&&key.match(SiteMap.PATTERN_PATH_FACE)&&i.add(e)}),Object.keys(t).forEach(e=>{if("string"==typeof e&&e.match(SiteMap.PATTERN_PATH_FACE)){var r=t[e];(null==r||Array.isArray(r))&&(e=Path.normalize(e),o.has(e)||o.set(e,[]),(r=r||[]).forEach(t=>{if("string"!=typeof t)throw new TypeError("Invalid facet: "+typeof t);if(!(t=t.toLowerCase().trim()).match(SiteMap.PATTERN_PATH_FACET)&&!t.match(SiteMap.PATTERN_PATH_FACET_VARIABLE))throw new Error("Invalid facet"+(t?": "+t:""));if(t.match(SiteMap.PATTERN_PATH_FACET_VARIABLE)){var r=(t=t.replace(/\.+$/,""))?e.replace(/#+$/,"")+"#"+t:e;if(i.has(r)||i.add(r),!t)return}o.get(e).includes(t)||o.get(e).push(t),a.set(Path.normalize(e,t),{path:e,facet:t})}))}}),SiteMap.acceptors.clear(),r.forEach((e,t,r)=>{SiteMap.acceptors.add(e)}),SiteMap.paths.clear(),o.forEach((e,t,r)=>{SiteMap.paths.set(t,e)}),SiteMap.facets.clear(),a.forEach((e,t,r)=>{SiteMap.facets.set(t,e)}),SiteMap.variables.clear(),(i=Array.from(i)).sort((e,t)=>e.localeCompare(t)),i.forEach(e=>{SiteMap.variables.add(e)})}},Composite.customize(e=>{if(e instanceof Element&&e.hasAttribute(Composite.ATTRIBUTE_COMPOSITE)&&!e.hasAttribute("static")){for(var t="",r=e;r;r=r.parentNode)if(r instanceof Element&&r.hasAttribute(Composite.ATTRIBUTE_COMPOSITE)){var o=(r.getAttribute(Composite.ATTRIBUTE_ID)||"").trim();if(!o.match(Composite.PATTERN_COMPOSITE_ID))throw new Error("Invalid composite id"+(o?": "+o:""));t="#"+o+t}var a=null;e.hasAttribute(Composite.ATTRIBUTE_CONDITION)&&(a=e.getAttribute(Composite.ATTRIBUTE_CONDITION).trim()).match(Composite.PATTERN_EXPRESSION_CONTAINS)&&(a=a.replace(Composite.PATTERN_EXPRESSION_CONTAINS,(e,r,o)=>(e=e.substring(2,e.length-2).trim(),'{{SiteMap.accept("'+t+'") and ('+e+")}}"))),a||(a=(a||"")+'{{SiteMap.accept("'+t+'")}}'),e.setAttribute(Composite.ATTRIBUTE_CONDITION,a)}}),Composite.customize("@ATTRIBUTES-STATICS","static"),window.addEventListener("load",e=>{document.body.addEventListener("click",e=>{if(e.target&&e.target instanceof Element&&e.target.hasAttribute("href")){var t=SiteMap.lookup(e.target.getAttribute("href")),r=SiteMap.lookup(Path.normalize(SiteMap.location));r&&t&&r.face==t.face&&r.facet==t.facet&&"function"==typeof t.focus&&t.focus()}}),SiteMap.forward(window.location.hash||"#")}),window.addEventListener("hashchange",e=>{var t=SiteMap.history.size<=0;if(SiteMap.paths.size<=0)t&&Composite.render(document.body);else{var r=Path.normalize(SiteMap.location),o=(e.newURL||"").replace(Path.PATTERN_URL,"$1"),a=SiteMap.locate(o);if(a.match(Path.PATTERN_PATH_FUNCTIONAL)&&t&&(a="#"),a.match(Path.PATTERN_PATH_FUNCTIONAL))history.replaceState(null,document.title,SiteMap.location);else if(a!=window.location.hash||a!=SiteMap.location||t){var i=SiteMap.permit(a);if(!0===i){SiteMap.location=a,r=SiteMap.lookup(r),a=SiteMap.lookup(a),(r=r.face).endsWith("#")||(r+="#"),(a=a.face).endsWith("#")||(a+="#");var n="#";r.startsWith(a)?n=a:a.startsWith(r)&&(n=r),(n=n.match(/((?:#[^#]+)|(?:^))#*$/))&&n[1]&&!t?Composite.render(n[1]):Composite.render(document.body),window.location.assign(SiteMap.location),window.location.hash=window.location.hash}else"string"==typeof i?SiteMap.forward(i):SiteMap.forward("#"!=a?a+"##":"#")}}})),"undefined"==typeof Test&&(window.Test={get PATTERN_EVENT(){return/^[a-z]+$/},get EVENT_FINISH(){return"finish"},get EVENT_INTERRUPT(){return"interrupt"},get EVENT_PERFORM(){return"perform"},get EVENT_RESPONSE(){return"response"},get EVENT_RESUME(){return"resume"},get EVENT_START(){return"start"},get EVENT_SUSPEND(){return"suspend"}},Test.activate=function(){void 0===Test.activate.lock&&(Object.defineProperty(Test.activate,"lock",{value:!0}),Object.defineProperty(Test,"stack",{value:new Set}),Object.defineProperty(Test,"listeners",{value:new Map}),Test.listen=function(e,t){if("string"!=typeof e)throw new TypeError("Invalid event: "+typeof e);if("function"!=typeof t&&null!=t)throw new TypeError("Invalid callback: "+typeof t);if(!e.match(Test.PATTERN_EVENT))throw new Error("Invalid event"+(e.trim()?": "+e:""));e=e.toLowerCase(),Test.listeners.has(e)||Array.isArray(Test.listeners.get(e))||Test.listeners.set(e,[]),Test.listeners.get(e).push(t)},Test.fire=function(e,t){"object"==typeof Test.worker&&(Test.worker.status=e);var r=(e,t,r)=>{if("object"==typeof e.Test.worker&&"object"==typeof e.Test.worker.monitor&&"function"==typeof e.Test.worker.monitor[t])try{e.Test.worker.monitor[t](r)}catch(e){console.error(e)}if(t=(t||"").trim(),!(e.Test.listeners.size<=0)&&t){var o=e.Test.listeners.get(t.toLowerCase());Array.isArray(o)&&o.forEach(e=>{e(t,r)})}};if(r(window,e,t),parent&&parent!==window)try{r(parent,e,t)}catch(e){}},Test.create=function(e){if("object"==typeof e&&"function"==typeof e.test&&(void 0===e.ignore||!0!==e.ignore)&&!Test.stack.has(e)){Test.stack.add(e);var t=Array.from(Test.stack);Object.defineProperty(e,"serial",{value:Math.max(t.length,t.length>1?t[t.length-2].serial+1:1)})}},Test.start=function(e){if(void 0===Test.worker)if(!e||!e.auto||"loading"!=document.readyState&&"interactive"!=document.readyState){var t=(e,t)=>e+" "+t+(1!=e?"s":"");Test.worker={},Test.worker.output=e?e.output:null,Test.worker.output=Test.worker.output||console,Test.worker.monitor=e?e.monitor:null,Test.worker.monitor=Test.worker.monitor||{start(e){Test.worker.output.log((new Date).toUTCString()+" Test is started, "+t(e.queue.size,"task")+" in the queue")},suspend(e){Test.worker.output.log((new Date).toUTCString()+" Test is suspended, "+t(e.queue.length,"task")+" still outstanding")},resume(e){Test.worker.output.log((new Date).toUTCString()+" Test is continued , "+t(e.queue.size,"task")+" in the queue")},interrupt(e){Test.worker.output.log((new Date).toUTCString()+" Test is interrupted\n\t"+t(e.queue.size-e.queue.progress,"task")+" still outstanding\n\t"+t(e.queue.faults,"fault")+" were detected\n\ttotal time "+((new Date).getTime()-e.queue.timing)+" ms")},perform(e){},response(e){var t=(new Date).getTime()-e.task.timing;e.task.error?Test.worker.output.error((new Date).toUTCString()+" Test task "+e.task.title+" "+e.task.error.message):Test.worker.output.log((new Date).toUTCString()+" Test task "+e.task.title+" was successful ("+t+" ms)")},finish(e){Test.worker.output.log((new Date).toUTCString()+" Test is finished\n\t"+t(e.queue.size,"task")+" were performed\n\t"+t(e.queue.faults,"fault")+" were detected\n\ttotal time "+((new Date).getTime()-e.queue.timing)+" ms")}},Test.worker.queue=Test.worker.queue||{timing:!1,stack:[],size:0,lock:!1,progress:0,faults:0},0==Test.worker.queue.stack.length&&(Test.worker.queue.stack=Array.from(Test.stack),Test.worker.queue.size=Test.worker.queue.stack.length,Test.worker.queue.timing=(new Date).getTime()),Test.worker.timeout=window.setInterval(()=>{if(Test.worker.status!=Test.EVENT_SUSPEND&&void 0!==Test.worker.task&&Test.worker.task.running&&Test.worker.queue.lock){var e=Test.worker.task;!e.timeout||e.timeout>(new Date).getTime()||(e.duration=(new Date).getTime()-e.timing,e.error=new Error("Timeout occurred, expected "+e.timeout+" ms but was "+e.duration+" ms"),Test.fire(Test.EVENT_RESPONSE,Test.status()),Test.worker.queue.faults++,Test.worker.queue.lock=!1)}},25),Test.worker.interval=window.setInterval(()=>{if(Test.worker.status!=Test.EVENT_SUSPEND&&(!Test.worker.queue.lock&&Test.worker.queue.progress<=0&&Test.fire(Test.EVENT_START,Test.status()),!Test.worker.queue.lock)){if(Test.worker.queue.stack.length>0){Test.worker.queue.lock=!0,Test.worker.queue.progress++;var e=Test.worker.queue.stack.shift(),t=!1;return(e.timeout||0)>0&&(t=(new Date).getTime()+e.timeout),Test.worker.task={title:null,meta:e,running:!0,timing:(new Date).getTime(),timeout:t,duration:!1,error:null},Test.worker.task.title="#"+e.serial,"string"==typeof e.name&&e.name.trim().length>0&&(Test.worker.task.title+=" "+e.name.replace(/[\x00-\x20]+/g," ").trim()),Test.fire(Test.EVENT_PERFORM,Test.status()),void Composite.asynchron(()=>{var e=Test.worker.task;try{e.meta.test()}catch(t){e.error=t,e.error.message&&e.error.message.trim()||(e.error.message="failed")}finally{e.meta.expected&&(e.error?("function"==typeof e.meta.expected&&e.error instanceof e.meta.expected&&(e.error=null),"object"==typeof e.meta.expected&&e.meta.expected instanceof RegExp&&String(e.error).match(e.meta.expected)&&(e.error=null)):e.error=Error("Assert error expected failed")),e.running=!1,e.duration=(new Date).getTime()-e.timing,e.timeout&&e.timeout<(new Date).getTime()&&!e.error&&(e.error=new Error("Timeout occurred, expected "+e.meta.timeout+" ms but was "+e.duration+" ms"),Test.fire(Test.EVENT_RESPONSE,Test.status()),Test.worker.queue.faults++),e.error&&String(e.error.message).match(/^Timeout occurred/)||(e.error&&Test.worker.queue.faults++,Test.fire(Test.EVENT_RESPONSE,Test.status())),Test.worker.queue.lock=!1}})}window.clearTimeout(Test.worker.interval),window.clearTimeout(Test.worker.timeout),Test.fire(Test.EVENT_FINISH,Test.status()),delete Test.worker}},25)}else void 0===Test.start.auto&&(Object.defineProperty(Test.start,"auto",{value:!0}),window.addEventListener("load",()=>{Test.start(e)}))},Test.suspend=function(){if(void 0===Test.worker)throw new Error("Suspend is not available");Test.fire(Test.EVENT_SUSPEND,Test.status())},Test.resume=function(){if(void 0===Test.worker||Test.worker.status!==Test.EVENT_SUSPEND)throw new Error("Resume is not available");Test.fire(Test.EVENT_RESUME,Test.status())},Test.interrupt=function(){if(void 0===Test.worker)throw new Error("Interrupt is not available");window.clearTimeout(Test.worker.interval),window.clearTimeout(Test.worker.timeout),Test.fire(Test.EVENT_INTERRUPT,Test.status()),delete Test.worker},Test.status=function(){var e={};return"object"==typeof Test.worker&&"object"==typeof Test.worker.task&&(e.task={},Object.defineProperty(e.task,"title",{value:Test.worker.task.title,enumerable:!0}),Object.defineProperty(e.task,"meta",{value:Test.worker.task.meta,enumerable:!0}),Object.defineProperty(e.task,"running",{value:Test.worker.task.running,enumerable:!0}),Object.defineProperty(e.task,"timing",{value:Test.worker.task.timing,enumerable:!0}),Object.defineProperty(e.task,"timeout",{value:Test.worker.task.timeout,enumerable:!0}),Object.defineProperty(e.task,"duration",{value:Test.worker.task.duration,enumerable:!0}),Object.defineProperty(e.task,"error",{value:Test.worker.task.error,enumerable:!0})),"object"==typeof Test.worker&&"object"==typeof Test.worker.queue&&(e.queue={},Object.defineProperty(e.queue,"timing",{value:Test.worker.queue.timing,enumerable:!0}),Object.defineProperty(e.queue,"size",{value:Test.worker.queue.size,enumerable:!0}),Object.defineProperty(e.queue,"length",{value:Test.worker.queue.stack.length,enumerable:!0}),Object.defineProperty(e.queue,"progress",{value:Test.worker.queue.progress,enumerable:!0}),Object.defineProperty(e.queue,"lock",{value:Test.worker.queue.lock,enumerable:!0}),Object.defineProperty(e.queue,"faults",{value:Test.worker.queue.faults,enumerable:!0})),(void 0!==e.task||void 0!==e.queue)&&e},"undefined"==typeof Assert&&(window.Assert={},Assert.create=function(arguments,e){var t={message:null,values:[],error(){var e=Array.from(arguments);e.forEach((e,r,o)=>{o[r]=String(e).replace(/\{(\d+)\}/g,(e,r)=>r>t.values.length?"[null]":String(t.values[r]).replace(/\s*[\r\n]+\s*/g," "))});var r="expected {1} but was {2}";return null!=t.message&&(t.message=t.message.trim(),t.message&&(r=t.message)),r=(r="{0} failed, "+r).replace(/\{(\d+)\}/g,(t,r)=>r>e.length?"[null]":String(e[r]).replace(/\s*[\r\n]+\s*/g," ")),new Error(r)}};for((arguments=Array.from(arguments)).length>e&&(t.message=arguments.shift());arguments.length>0;)t.values.push(arguments.shift());return t},Assert.assertTrue=function(e){var t=Assert.create(arguments,1);if(!0!==t.values[0])throw t.error("Assert.assertTrue","true","{0}")},Assert.assertFalse=function(e){var t=Assert.create(arguments,1);if(!1!==t.values[0])throw t.error("Assert.assertFalse","false","{0}")},Assert.assertEquals=function(e){var t=Assert.create(arguments,2);if(t.values[0]!==t.values[1])throw t.error("Assert.assertEquals","{0}","{1}")},Assert.assertNotEquals=function(e){var t=Assert.create(arguments,2);if(t.values[0]===t.values[1])throw t.error("Assert.assertNotEquals","not {0}","{1}")},Assert.assertSame=function(e){var t=Assert.create([],arguments,2);if(t.values[0]!=t.values[1])throw t.error("Assert.assertSame","{0}","{1}")},Assert.assertNotSame=function(e){var t=Assert.create(arguments,2);if(t.values[0]==t.values[1])throw t.error("Assert.assertNotSame","not {0}","{1}")},Assert.assertNull=function(e){var t=Assert.create(arguments,1);if(null!==t.values[0])throw t.error("Assert.assertNull","null","{0}")},Assert.assertNotNull=function(e){var t=Assert.create(arguments,1);if(null===t.values[0])throw t.error("Assert.assertNotNull","not null","{0}")},Assert.fail=function(e){throw e&&(e=String(e).trim()),e="Assert.fail"+(e?", "+e:""),new Error(e)}),console.output={log:"",warn:"",error:"",info:""},console.output.clear=function(){console.output.log="",console.output.warn="",console.output.error="",console.output.info=""},Object.defineProperty(console,"listeners",{value:new Set}),console.listen=function(e){console.listeners.add(e)},console.forward=function(e,t,r){console.output[e]+=Array.from(t).join(", "),r&&r(...t);var o=[e,...t];console.listeners.forEach(e=>{e(...o)}),(arguments=Array.from(arguments)).length>2&&(arguments[2]=null),parent&&parent!==window&&parent.console&&"function"==typeof parent.console.forward&&parent.console.forward(...arguments)},console.log$origin=console.log,console.log=function(e){console.forward("log",arguments,console.log$origin)},console.warn$origin=console.warn,console.warn=function(e){console.forward("warn",arguments,console.warn$origin)},console.error$origin=console.error,console.error=function(e){console.forward("error",arguments,console.error$origin)},console.info$origin=console.info,console.info=function(e){console.forward("info",arguments,console.info$origin)},window.addEventListener("error",function(e){parent&&parent!==window&&console.forward("error",function(){return arguments}(e.message),null)}),void 0===Element.prototype.typeValue&&(Element.prototype.typeValue=function(e,t){this.focus(),!1!==t&&(this.value="");var r=this;(e=(e||"").split("")).forEach(e=>{r.trigger("keydown"),r.value=(r.value||"")+e,r.trigger("keyup")}),this.trigger("input")}),void 0===Node.prototype.toPlainString&&(Node.prototype.toPlainString=function(){return(new XMLSerializer).serializeToString(this)}),void 0===Element.prototype.toPlainString&&(Element.prototype.toPlainString=function(){return this.outerHTML}),void 0===Object.prototype.toPlainString&&(Object.prototype.toPlainString=function(){return null!=this&&"function"==typeof this[Symbol.iterator]?JSON.stringify([...this]):JSON.stringify(this)}),void 0===Element.prototype.trigger&&(Element.prototype.trigger=function(e,t,r){var o=document.createEvent("Event");arguments.length<2&&(t=!1),arguments.length<3&&(r=!0),o.initEvent(e,t,r),this.dispatchEvent(o)}))});